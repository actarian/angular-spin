<form class="main-search" name="mainSearch" role="form" novalidate autocomplete="off" (ngSubmit)="onSubmit()" #mainSearch="ngForm">
	<!-- DESTINATION -->
	<div class="main-search--col main-search--location" [ngClass]="{'active':active==searchLocation}">
		<div (click)="active = searchLocation" #searchLocation>
			<label for="main-search--location">Destinazione</label>
			<input type="search" id="main-search--location" placeholder="Cerca località, regione, tipologia o nome hotel" [value]="model.destination.name" (focus)="model.query = null; model.destination = null;" *ngIf="model.destination">
			<input type="search" id="main-search--location" placeholder="Cerca località, regione, tipologia o nome hotel" name="query" [(ngModel)]="model.query" [hidden]="model.destination" #query>
			<span class="ico">
				<svg>
					<use xlink:href="#ico-pin"></use>
				</svg>
			</span>
		</div>
		<!-- LAST DESTINATIONS -->
		<div class="popup-hint popup-hint__last-search popup-hint__destination" #lastSearch *ngIf="!destinationDirty">
			<div class="popup-hint--head">
				<h3>Le tue ultime ricerche</h3>
				<div class="popup-hint--close" (click)="active=null">
					<svg>
						<use xlink:href="#ico-circle-close"></use>
					</svg>
				</div>
			</div>
			<div class="popup-hint--body">
				<ul class="popup-hint--list">
					<li class="popup-hint--item">
						<span class="popup-hint--ico">
							<svg>
								<use xlink:href="#ico-pin"></use>
							</svg>
						</span>
						<h4 class="popup-hint--tit">Emilia Romagna</h4>
						<div class="popup-hint--info">
							<div class="popup-hint--location">
								Italia
							</div>
							<div class="popup-hint--type">
								Regione
							</div>
						</div>
					</li>
					<li class="popup-hint--item">
						<span class="popup-hint--ico">
							<svg>
								<use xlink:href="#ico-struttura"></use>
							</svg>
						</span>
						<h4 class="popup-hint--tit">FAMILY HOTEL ADAMELLO</h4>
						<div class="popup-hint--info">
							<div class="popup-hint--location">
								Passo Tonale (TN) - dal 06/12 al 31/03
							</div>
							<div class="popup-hint--type">
								Hotel
							</div>
						</div>
					</li>
					<li class="popup-hint--item">
						<span class="popup-hint--ico">
							<svg>
								<use xlink:href="#ico-pin"></use>
							</svg>
						</span>
						<h4 class="popup-hint--tit">Firenze</h4>
						<div class="popup-hint--info">
							<div class="popup-hint--location">
								Italia
							</div>
							<div class="popup-hint--type">
								Regione
							</div>
						</div>
					</li>
				</ul>
			</div>
		</div>
		<!-- AUTOCOMPLETE DESTINATIONS -->
		<div class="popup-hint popup-hint__autocomplete popup-hint__destination" #autocomplete *ngIf="destinationDirty && !model.destination">
			<div class="popup-hint--body">
				<ul class="popup-hint--list">
					<!-- DESTINATION ITEM -->
					<li class="popup-hint--item" *ngFor="let destination of destinations" (click)="onSetDestination(destination)">
						<span class="popup-hint--ico">
							<svg [ngSwitch]="destination.type">
								<use *ngSwitchCase="1" xlink:href="#ico-star"></use>
								<use *ngSwitchCase="2" xlink:href="#ico-pin"></use>
								<use *ngSwitchCase="3" xlink:href="#ico-pin"></use>
								<use *ngSwitchCase="4" xlink:href="#ico-pin"></use>
								<use *ngSwitchCase="5" xlink:href="#ico-struttura"></use>
							</svg>
						</span>
						<h4 class="popup-hint--tit" [innerHTML]="destination.name | highlight : model.query">---</h4>
						<div class="popup-hint--info">
							<div class="popup-hint--location" [innerHTML]="destination.abstract | highlight : model.query">---</div>
							<div class="popup-hint--type">{{ destination | destinationType }}</div>
						</div>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<!-- DATE -->
	<div class="main-search--col main-search--date" [ngClass]="{'active':active==searchDate}">
		<div class="main-search--trigger" (click)="active = searchDate" #searchDate>
			<label for="main-search--date">Data di partenza</label>
			<input disabled type="text" id="main-search--date" placeholder="Seleziona una data" [value]="model.startDate | date:'dd MMMM yyyy'">
			<span class="ico">
				<svg>
					<use xlink:href="#ico-calendar"></use>
				</svg>
			</span>
		</div>
		<div class="popup-hint popup-hint__date">
			<div class="popup-hint--head">
				<h3>Seleziona la data di partenza</h3>
				<div class="popup-hint--close" (click)="active=null">
					<svg>
						<use xlink:href="#ico-circle-close"></use>
					</svg>
				</div>
			</div>
			<div class="popup-hint--body">
				<div class="popup-hint--flexible-date">
					<div class="checkbox">
						<label>
							<input checked type="checkbox" name="flexibleDates" [(ngModel)]="model.flexibleDates" />
							<span>Date flessibili +/- 3 giorni?</span>
						</label>
					</div>
				</div>
				<div class="calendar popup-calendar">
					<p-calendar name="startDate" [(ngModel)]="model.startDate" [inline]="true" [monthNavigator]="true" [yearNavigator]="true" [yearRange]="calendar.minYear + ':' + calendar.maxYear" [minDate]="calendar.minDate" [maxDate]="calendar.maxDate" [locale]="calendar.it" dateFormat="dd/mm/yy"></p-calendar>
				</div>
			</div>
		</div>
	</div>
	<!-- DURATION -->
	<div class="main-search--col main-search--duration" [ngClass]="{'active':active==searchDuration}">
		<div (click)="active = searchDuration" #searchDuration>
			<label for="main-search--duration">Durata viaggio</label>
			<input disabled id="main-search--duration" type="text" class="main-search--duration" [value]="model.duration.name">
			<span class="ico">
				<svg>
					<use xlink:href="#ico-clock"></use>
				</svg>
			</span>
		</div>
		<div class="popup-hint popup-hint__duration">
			<div class="popup-hint--head">
				<h3>Seleziona la durata del tuo viaggio</h3>
				<div class="popup-hint--close" (click)="active=null">
					<svg>
						<use xlink:href="#ico-circle-close"></use>
					</svg>
				</div>
			</div>
			<div class="popup-hint--body">
				<ul class="popup-hint--list">
					<li class="popup-hint--check" *ngFor="let duration of durations">
						<div class="radio">
							<label>
								<input name="main-search--duration" type="radio" name="duration" [value]="duration" [(ngModel)]="model.duration"/>
								<span>{{duration.name}}</span>
							</label>
						</div>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<!-- ADULTS -->
	<div class="main-search--col main-search--adults" [ngClass]="{'active':active==searchAdults}">
		<div class="main-search--trigger" (click)="active=searchAdults" #searchAdults>
			<label for="main-search--adults">Adulti</label>
			<input disabled id="main-search--adults" type="text" [value]="model.adults" #adults>
			<span class="ico">
				<svg>
					<use xlink:href="#ico-adult"></use>
				</svg>
			</span>
		</div>
		<div class="popup-hint popup-hint__adults">
			<div class="popup-hint--head">
				<h3>Numero di adulti</h3>
				<div class="popup-hint--close" (click)="active=null">
					<svg>
						<use xlink:href="#ico-circle-close"></use>
					</svg>
				</div>
			</div>
			<div class="popup-hint--body">
				<div class="spinner-input">
					<strong for="">Adulti</strong>
					<p-spinner size="10" readonly name="adults" [(ngModel)]="model.adults" [min]="1" [max]="10"></p-spinner>
				</div>
			</div>
		</div>
	</div>
	<!-- CHILDS -->
	<div class="main-search--col main-search--childs" [ngClass]="{'active':active==searchChilds}">
		<div class="main-search--trigger" (click)="active=searchChilds" #searchChilds>
			<label for="main-search--childs">Bambini</label>
			<input disabled id="main-search--childs" type="text" [value]="model.childs" #childs>
			<span class="ico">
				<svg>
					<use xlink:href="#ico-child"></use>
				</svg>
			</span>
		</div>
		<div class="popup-hint popup-hint__childs">
			<div class="popup-hint--head">
				<h3>Numero di bambini</h3>
				<div class="popup-hint--close" (click)="active=null">
					<svg>
						<use xlink:href="#ico-circle-close"></use>
					</svg>
				</div>
			</div>
			<div class="popup-hint--body">
				<div class="spinner-input">
					<strong>Bambini</strong>
					<p-spinner size="10" readonly name="childs" [(ngModel)]="model.childs" [min]="0" [max]="4" (onChange)="onChildsChanged()"></p-spinner>
				</div>
				<div class="child-ages">
					<div class="child-age" *ngFor="let child of model.childrens; let index = $index">
						<strong>Età bambino {{index}}</strong>
						<div class="custom-select">
							<select dir="rtl" name="age" [(ngModel)]="child.age">
								<option *ngFor="let age of ages" [value]="age">{{age}}</option>
							</select>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- SEARCH -->
	<div class="main-search--col main-search--submit">
		<button type="submit" class="btn">{{ 'app.search' | translate }}</button>
	</div>
</form>
