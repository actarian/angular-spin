<form class="main-search" name="mainSearch" role="form" novalidate autocomplete="off" #mainSearch="ngForm">
	<!-- DESTINATION -->
	<div class="main-search__col main-search__location" [ngClass]="{'active':active==searchLocation}" (clickOutside)="active == searchLocation ? active=null : null">
		<div (click)="active = searchLocation" #searchLocation>
			<label for="main-search--location">Destinazione</label>
			<input type="text" class="with-reset" id="main-search--location" placeholder="Cerca località, regione, tipologia o nome hotel" name="query" [(ngModel)]="model.query" (focus)="model.destination = null; model.query = null" #query>
			<span class="reset" (click)="model.destination = null; model.query = null; query.focus()" [hidden]="!model.query && !model.destination">
				<svg>
					<use xlink:href="#ico-reset"></use>
				</svg>
			</span>
			<span class="ico">
				<svg>
					<use xlink:href="#ico-pin"></use>
				</svg>
			</span>
		</div>
		<!-- LAST DESTINATIONS -->
		<div class="popup-hint popup-hint--last-search popup-hint__destination" #lastSearch *ngIf="!model.query && !model.destination && search.lastDestinations?.length">
			<div class="head">
				<h3>Le tue ultime ricerche</h3>
				<div class="close" (click)="active=null">
					<svg>
						<use xlink:href="#ico-close"></use>
					</svg>
				</div>
			</div>
			<destination-hint [destinations]="search.lastDestinations" [height]="46" (selectDestination)="onDestinationSet($event)"></destination-hint>
		</div>
		<!-- AUTOCOMPLETE DESTINATIONS -->
		<div class="popup-hint popup-hint__autocomplete popup-hint__destination" #autocomplete *ngIf="model.query && !model.destination && search.destinations">
			<destination-hint [destinations]="search.destinations" [query]="model.query" [height]="46" (selectDestination)="onDestinationSet($event)"></destination-hint>
		</div>
	</div>
	<!-- DATE -->
	<div class="main-search__col main-search__date" [ngClass]="{'active':active==searchDate}" (clickOutside)="active == searchDate ? active=null : null">
		<div class="main-search--trigger" (click)="active = searchDate" #searchDate>
			<label for="main-search--date">Data di partenza</label>
			<input class="with-reset" disabled type="text" id="main-search--date" placeholder="Seleziona una data" [value]="model.startDate | date:'dd MMMM yyyy'">
			<span class="reset" (click)="this.model.startDate = null; query.focus()" [hidden]="!this.model.startDate">
				<svg>
					<use xlink:href="#ico-reset"></use>
				</svg>
			</span>
			<span class="ico">
				<svg>
					<use xlink:href="#ico-calendar"></use>
				</svg>
			</span>
		</div>
		<div class="popup-hint popup-hint__date">
			<div class="head">
				<h3>Seleziona la data di partenza</h3>
				<div class="close" (click)="active=null">
					<svg>
						<use xlink:href="#ico-close"></use>
					</svg>
				</div>
			</div>
			<div class="body">
				<div class="flexible-date">
					<div class="checkbox">
						<label>
							<input checked type="checkbox" name="flexibleDates" [(ngModel)]="model.flexibleDates" />
							<span>Date flessibili +/- 3 giorni?</span>
						</label>
					</div>
				</div>
				<div class="calendar popup-calendar">
					<p-calendar name="startDate" [(ngModel)]="model.startDate" [inline]="true" [monthNavigator]="true" [yearNavigator]="true" [yearRange]="search.calendar.minYear + ':' + search.calendar.maxYear" [minDate]="search.calendar.minDate" [maxDate]="search.calendar.maxDate" [locale]="search.calendar.it" dateFormat="dd/mm/yy"></p-calendar>
				</div>
			</div>
		</div>
	</div>
	<!-- DURATION -->
	<div class="main-search__col main-search__duration" [ngClass]="{'active':active==searchDuration}" (clickOutside)="active == searchDuration ? active=null : null">
		<div class="main-search--trigger" (click)="active = searchDuration" #searchDuration>
			<label for="main-search--duration">Durata viaggio</label>
			<input disabled id="main-search--duration" type="text" class="main-search--duration-input" [value]="model.duration.name">
			<span class="ico">
				<svg>
					<use xlink:href="#ico-clock"></use>
				</svg>
			</span>
		</div>
		<div class="popup-hint popup-hint__duration">
			<div class="head">
				<h3>Seleziona la durata del tuo viaggio</h3>
				<div class="close" (click)="active=null">
					<svg>
						<use xlink:href="#ico-close"></use>
					</svg>
				</div>
			</div>
			<div class="body">
				<ul class="popup-list">
					<li class="check" *ngFor="let duration of search.durations">
						<div class="radio">
							<label>
								<input name="main-search--duration" type="radio" name="duration" [value]="duration" [(ngModel)]="model.duration"/>
								<span>{{duration.name}}</span>
							</label>
						</div>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<!-- ADULTS -->
	<div class="main-search__col main-search__adults" [ngClass]="{'active':active==searchAdults}" (clickOutside)="active == searchAdults ? active=null : null">
		<div class="main-search--trigger" (click)="active=searchAdults" #searchAdults>
			<label for="main-search--adults">Adulti</label>
			<input disabled id="main-search--adults" type="text" [value]="model.adults" #adults>
			<span class="ico">
				<svg>
					<use xlink:href="#ico-adult"></use>
				</svg>
			</span>
		</div>
		<div class="popup-hint popup-hint__adults">
			<div class="head">
				<h3>Numero di adulti</h3>
				<div class="close" (click)="active=null">
					<svg>
						<use xlink:href="#ico-close"></use>
					</svg>
				</div>
			</div>
			<div class="body">
				<div class="spinner-input">
					<strong for="">Adulti</strong>
					<p-spinner size="10" readonly name="adults" [(ngModel)]="model.adults" [min]="1" [max]="10"></p-spinner>
				</div>
			</div>
		</div>
	</div>
	<!-- CHILDS -->
	<div class="main-search__col main-search__childs" [ngClass]="{'active':active==searchChilds}" (clickOutside)="active == searchChilds ? active=null : null">
		<div class="main-search--trigger" (click)="active=searchChilds" #searchChilds>
			<label for="main-search--childs">Bambini</label>
			<input disabled id="main-search--childs" type="text" [value]="model.childs" #childs>
			<span class="ico">
				<svg>
					<use xlink:href="#ico-child"></use>
				</svg>
			</span>
		</div>
		<div class="popup-hint popup-hint__childs">
			<div class="head">
				<h3>Numero di bambini</h3>
				<div class="close" (click)="active=null">
					<svg>
						<use xlink:href="#ico-close"></use>
					</svg>
				</div>
			</div>
			<div class="body">
				<div class="spinner-input">
					<strong>Bambini</strong>
					<p-spinner size="10" readonly name="childs" [(ngModel)]="model.childs" [min]="0" [max]="4" (onChange)="onChildsChanged()"></p-spinner>
				</div>
				<div class="child-ages">
					<div class="child-age" *ngFor="let child of model.childrens; let index = $index">
						<strong>Età bambino {{index}}</strong>
						<div class="custom-select">
							<select dir="rtl" name="age" [(ngModel)]="child.age">
								<option *ngFor="let age of search.ages" [value]="age">{{age}}</option>
							</select>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- SEARCH -->
	<div class="main-search__col main-search__submit">
		<button type="button" class="btn" (click)="onSubmit()">{{ 'app.search' | translate }}</button>
	</div>
</form>
